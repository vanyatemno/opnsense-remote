<p>Hi there,</p><p>For more than 7 and a half years now, OPNsense is driving innovation through modularising and hardening the open source firewall, with simple and reliable firmware upgrades, multi-language support, fast adoption of upstream software updates as well as clear and stable 2-Clause BSD licensing.</p><p>22.7, nicknamed "Powerful Panther", features the upgrade to FreeBSD 13.1, PHP 8.0, Phalcon 5, stacked VLAN and Intel QuickAssist (QAT) support, DDoS protection using SYN cookies, MVC/API pages for IPsec status and Unbound overrides, new APCUPSD and CrowdSec plugins plus much more.</p><p>LibreSSL flavour is scheduled for removal at the end of this series and will likely receive no further maintenance.  Software failing to work properly starting with Tor will have its plugin removed from the flavour from now on to be able to keep updating the software to their latest versions in the OpenSSL flavour.  The next major upgrade will automatically transition to the OpenSSL flavour, but we would encourage everyone to switch between 22.7.x for the least amount of possible impact.</p><p>Download links, an installation guide[<a target="_blank" href="https://docs.opnsense.org/manual/install.html">1</a>] and the checksums for the images can be found below as well.</p><p><ul><li>Europe: <a target="_blank" href="https://opnsense.c0urier.net/releases/22.7/">https://opnsense.c0urier.net/releases/22.7/</a></li><li>US East Coast: <a target="_blank" href="https://mirror.wdc1.us.leaseweb.net/opnsense/releases/22.7/">https://mirror.wdc1.us.leaseweb.net/opnsense/releases/22.7/</a></li><li>US West Coast: <a target="_blank" href="https://mirror.sfo12.us.leaseweb.net/opnsense/releases/22.7/">https://mirror.sfo12.us.leaseweb.net/opnsense/releases/22.7/</a></li><li>South America: <a target="_blank" href="http://mirror.ueb.edu.ec/opnsense/releases/22.7/">http://mirror.ueb.edu.ec/opnsense/releases/22.7/</a></li><li>East Asia: <a target="_blank" href="https://mirror.ntct.edu.tw/opnsense/releases/22.7/">https://mirror.ntct.edu.tw/opnsense/releases/22.7/</a></li><li>Full mirror list: <a target="_blank" href="https://opnsense.org/download/">https://opnsense.org/download/</a></li></ul></p><p>Here are the full patch notes against 22.1.10:</p><p><ul><li>system: changed certificate revocation to use the phpseclib library</li><li>system: performance improvement for set_single_sysctl()</li><li>system: restart syslog fully and only once after all services have been started</li><li>system: new setting for deployment mode to control PHP error flow</li><li>system: /tmp MFS now uses a maximum of 50% of RAM by default and can be adjusted</li><li>system: /var MFS becomes /var/log MFS and uses a maximum of 50% of RAM by default and can be adjusted</li><li>system: previous special /var MFS content is now permanently stored under /var to ensure full operability</li><li>system: flush all core Python pyc files on updates</li><li>system: protect syslog-ng against out of memory kills</li><li>system: add filter to system log widget (contributed by kulikov-a)</li><li>system: disable RRD and NetFlow shutdown backups by default</li><li>system: render interfaces in convert_config()</li><li>system: apply default firewall policy before interface configuration</li><li>system: move remote backup script to proper file system location</li><li>system: disable flag was not removing static route</li><li>system: Net_IPv6::compress() should not compress "::" to ""</li><li>system: fix RADIUS config validation for port requirement (contributed by Josh Soref)</li><li>system: remove last bits of circular logging (CLOG) support</li><li>system: removed legacy Diffie-Hellman parameter handling</li><li>interfaces: refactored LAGG, wireless and static ARP handling</li><li>interfaces: provide automatic startup of Loopback, IPsec, OpenVPN, VXLAN devices</li><li>interfaces: removed the side effect reliance on /var/run/booting file</li><li>interfaces: add dynamic reload of required devices</li><li>interfaces: add WPA enterprise configuration for infrastructure mode (contributed by Manuel Faux)</li><li>interfaces: fix "Allow service binding" for multiple aliases per interface (contributed by Adam Dawidowski)</li><li>interfaces: auto-detect far gateway requirement for default route</li><li>interfaces: switch to MVC/API variant for DNS lookup page</li><li>interfaces: refactor DHCP and PPPoE scripts to use ifctl exclusively</li><li>interfaces: prevent the removal of default routes in dhclient-script</li><li>interfaces: fix inconsistencies in wireless handling</li><li>interfaces: fix unable to bring up multiple loopback (contributed Johnny S. Lee)</li><li>interfaces: fix unable to bring up multiple VXLAN</li><li>interfaces: check if int before passing to convert_seconds_to_hms()</li><li>interfaces: disable IPv6 inside 4in6 and 4in4 GIF tunnels (contributed by Maurice Walker)</li><li>interfaces: ping diagnostics tool must explicitly set IP version (contributed by Maurice Walker)</li><li>interfaces: remove other inconsistencies regarding ping utility changes in FreeBSD 13</li><li>interfaces: correct regex validation for dhcp6c expire statement (contributed by Josh Soref)</li><li>interfaces: add missing scope to link-local GIF host route</li><li>interfaces: add iwlwiwi(4) to wireless devices</li><li>firewall: improved port alias performance</li><li>firewall: obsoleted notices inside the synchronization code</li><li>firewall: support logging in NPT rules</li><li>firewall: append missing link-local to inet6 :network selector</li><li>firewall: move inspect action into its own async API action to prevent long page loads</li><li>firewall: internal aliases cannot be disabled</li><li>firewall: performance improvement for reading live log</li><li>firewall: ignore age/expire when not provided or empty in sessions page</li><li>firewall: add general firewall log for alias and filter system log messages</li><li>dhcp: no longer automatically add a link-local address to bridges if IPv6 service is running on it</li><li>dhcp: allow running relay service on bridges</li><li>dhcp: clean up IPv6 prefixes script</li><li>dhcp: include ddns-hostname and other cleanups (contributed by Sascha Buxhofer)</li><li>dhcp: remove duplicated ddnsupdate static mapping switch</li><li>dhcp: remove print_content_box() use</li><li>dhcp: switch to shell-based DHCPv6 lease watcher</li><li>dhcp: rewrite prefix merge for dynamic IPv6 tracking to support bitwise selection</li><li>dnsmasq: switch to a Python-based DHCP lease watcher</li><li>firmware: console script can now show changelog using "less" before update</li><li>firmware: disable crash reporter in development deployment mode</li><li>firmware: limit changelog-based update check on dashboard to release version</li><li>firmware: provide an upgrade log audit</li><li>intrusion detection: remove dead link to McAfee rule references</li><li>ipsec: add "IPv4+6" protocol for mobile phase 1 entries (contributed by vnxme)</li><li>ipsec: mobile property boolean duplication in phase 2</li><li>ipsec: remember phase 1 setting for next action</li><li>ipsec: switch to MVC/API variants of SPD, SAD and connection pages</li><li>ipsec: small UX tweaks in status page</li><li>openvpn: pinned Diffie-Hellman parameter to RFC 7919 4096 bit key</li><li>unbound: prevent crash of DHCP lease watcher due to unhandled CalledProcessError exception</li><li>lang: bring back Italian and update all languages to latest available translations</li><li>mvc: bugfix search and sort issues for searchRecordsetBase()</li><li>mvc: add support for non-persistent (memory) models</li><li>mvc: throw when no mount found in model (contributed by agh1467)</li><li>mvc: fix rowCount when all is selected in searchRecordsetBase()</li><li>mvc: fix two regressions in BaseField for Phalcon 5</li><li>mvc: store configuration changes only when actual changes exist</li><li>ui: removed Internet Explorer support</li><li>ui: boostrap-select ignored header height</li><li>ui: merge option objects instead of replacing them in bootgrid (contributed by agh1467)</li><li>ui: correct required API for command-info in bootgrid (contributed by agh1467)</li><li>ui: add catch undefined TypeError in SimpleActionButton (contributed by agh1467)</li><li>ui: fix assorted typos in the code base (contributed by Josh Soref)</li><li>ui: handle HTTP 500 error gracefully in MVC pages</li><li>plugins: os-apcupsd 1.0[<a target="_blank" href="https://github.com/opnsense/plugins/blob/stable/22.7/sysutils/apcupsd/pkg-descr">2</a>] (contributed by David Berry, Dan Lundqvist and Nicola Pellegrini)</li><li>plugins: os-boot-delay is no longer available[<a target="_blank" href="https://github.com/opnsense/plugins/blob/b31bcb92106/sysutils/boot-delay/Makefile#L6">3</a>]</li><li>plugins: os-crowdsec 1.0[<a target="_blank" href="https://github.com/opnsense/plugins/blob/stable/22.7/security/crowdsec/pkg-descr">4</a>]</li><li>plugins: os-nginx fix for missing DH parameter file</li><li>plugins: os-postfix fix for missing DH parameter file</li><li>plugins: os-tayga 1.2[<a target="_blank" href="https://github.com/opnsense/plugins/blob/stable/22.7/net/tayga/pkg-descr">5</a>]</li><li>plugins: os-tor no longer available on LibreSSL due to incompatibilities with newer Tor versions</li><li>plugins: os-web-proxy-useracl is no longer available, no updates since 2017</li><li>src: FreeBSD 13.1-RELEASE[<a target="_blank" href="https://www.freebsd.org/releases/13.1R/relnotes/">6</a>]</li><li>src: axgbe: also validate configuration register in GPIO expander</li><li>src: pf: ensure that pfiio_name is always nul terminated</li><li>src: pf: make sure that pfi_update_status() always zeros counters</li><li>src: igc: change default duplex setting</li><li>src: e1000: try auto-negotiation for fixed 100 or 10 configuration</li><li>ports: php 8.0.20[<a target="_blank" href="https://www.php.net/ChangeLog-8.php#8.0.20">7</a>]</li><li>ports: sqlite 3.39.0[<a target="_blank" href="https://sqlite.org/releaselog/3_39_0.html">8</a>]</li><li>ports: suricata 6.0.6[<a target="_blank" href="https://redmine.openinfosecfoundation.org/versions/176">9</a>]</li><li>ports: unbound 1.16.1[<a target="_blank" href="https://nlnetlabs.nl/projects/unbound/download/#unbound-1-16-1">10</a>]</li></ul></p><p>A hotfix release was issued as 22.7_4:</p><p><ul><li>system: IXR_Library using incorrect constructor format for PHP 8</li><li>interfaces: fix issues with PPP uptime display in PHP 8</li><li>firewall: do not emit link-local address on IPv6 network outbound NAT</li><li>mvc: remove stray error_reporting(E_ALL) calls</li></ul></p><p>Known issues and limitations:</p><p><ul><li>The DH parameter is no longer available in OpenVPN server configuration and now fixed to the RFC 7919 4096 bit key.  The only downside may be lower performance on older machines.</li><li>The infamous /var MFS feature was reduced to the /var/log scope in order to avoid future issues with plugins requiring persistent storage under /var.  In practice people who used /var MFS had no benefit over it with software that required persistent storage under /var to operate in the first place.  Periodic configuration file writes to /var are negligible on SSD-based systems.</li><li>The os-dyndns plugin is still available due to the fact that ddclient did not release a non-development release so far since we started os-ddclient.  Availability thereof might change later in 22.7.x.</li><li>The console firmware update will now display text-based changelogs for the update to be installed if available.  Use the arrow keys to scroll the changelog and type "q" to resume the update process.</li><li>The manual DHCPv6 tracking mode now requires a proper prefix range given like its counterpart with a static address.  If a previous prefix ID type input is detected only setting the lower 64 bits of an IPv6 address, a warning is emitted and the ID is treated as the upper 64 bits of an IPv6 address instead.  If your DHCPv6 server does not start please properly fix the given range.</li></ul></p><p>The public key for the 22.7 series is:</p><p><pre>-----BEGIN PUBLIC KEY-----
MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAs9U1NFG2420gDDQO97iU
S72sRdCaYCMoY2K8PpjrPGOkgDFN79YB+BYyUDZiO6aHJvy07yuDwhJcTiMWzuyF
Ub6BqdB2ehjP0+/Sh2z9eOWecI6s7rDxJVwaZRSagA3f5pDYj2LKtAqIPnv3Avs1
GTSHUZPR+V09UzUq/j0gRCNA+5hJrRwbyebaUGcp8QetUirmewAU5ArfXIBXvhn9
L9i8+r0/M/QbueSA7mOA4v2BDZVMAo1X72O6GZmpt+SY6A2fA9uvgYU/19hlCJQY
6eL16U4TG2Z1tyR6TIsjGZ973UDAFdZqDO4nqPeW/Dm20fnY/X6ZJcU1McbeDftZ
10lquuZBrFgxVDB6zBYX5319p1ASeYnSdhvFlK02P8a6OJS6JWmCx5j1VRAU8Zh1
W5xZRJJi6HmbX2b1ef2cy3ijtT/jviSNXEPR9V2otz9B+lc0g8P/hPwd7hpmdYj0
+KYcPaa1kmR4/xf++hb5XbOLt2Wc4mbyBph4VPeXiLYUfYlpYNwfvuP56zdylk+p
Mzw3XM1M36vA9oMXM9hLrrG67/UH6s4td//w4zdFPQ+A/rlVeF8EHsHICi6Salki
Z+R9FCNM61wU9HdAPOSpDn1aPQdW3HPNVmeI0iHPg42jIT1n1T0720XgHRTfntyh
E2+jioeukrqqEg1fzmszseMCAwEAAQ==
-----END PUBLIC KEY-----</pre></p><p><br>Stay safe,<br> Your OPNsense team</p><p><pre>SHA256 (OPNsense-22.7-OpenSSL-dvd-amd64.iso.bz2) = 9345057e993cd55dfa5280beefd33f1dc2243681defff3c5f11b84fa2c7910f8
SHA256 (OPNsense-22.7-OpenSSL-nano-amd64.img.bz2) = 061ea4ca261bcd8397ae1a4acf2fb32f0fbbb6ac00d617e1f4151318f66cc77d
SHA256 (OPNsense-22.7-OpenSSL-serial-amd64.img.bz2) = cf1603e20d4268d917b40344ddadd2f147c3e167dbe1f6cd254a2afcb586fb4d
SHA256 (OPNsense-22.7-OpenSSL-vga-amd64.img.bz2) = 2537f37247d98e27634c34cdf23f30f95d0ed00ac0af01c2d9675580a790f8fb</pre></p>